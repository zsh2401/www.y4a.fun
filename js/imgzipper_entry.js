!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=12)}({12:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const r=i(n(13)),a=new r.default,o=document.getElementById("upload"),u=document.getElementById("display"),s=document.getElementById("display-area"),l=document.getElementById("c-rate"),d=document.getElementById("before-size"),c=document.getElementById("compressed-size"),f=document.getElementById("conrols-panel"),h=document.getElementById("range");function p(e=.3){a.compress([...o.files],{size:4,quality:e}).then(e=>{console.log(e);const t=e[0],n=r.default.convertBase64ToFile(t.data,t.ext);console.log(n),u.src=t.prefix+t.data,c.textContent=n.size/1e3+""})}function v(){l.textContent=""+h.valueAsNumber,p((100-h.valueAsNumber)/100)}function g(){0!=o.files.length?(d.textContent=o.files[0].size/1e3+"",$(s).show(),$(f).show(),p((100-h.valueAsNumber)/100)):($(s).hide(),$(f).hide())}o.addEventListener("change",g,!1),h.addEventListener("change",v,!1)},13:function(e,t,n){e.exports=function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return e[i].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var i,r,a;r=[e,n(1),n(2),n(3),n(4),n(5),n(6)],i=function(e,t,n,i,r,a,o){"use strict";function u(e){return e&&e.__esModule?e:{default:e}}var s=u(t),l=u(n),d=u(i),c=u(r),f=u(a),h=u(o),p=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),v=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return p(e,[{key:"attach",value:function(e,t){var n=this;return new Promise(function(i,r){var a=document.querySelector(e);a.setAttribute("accept","image/*"),a.addEventListener("change",function(e){var r=n.compress([].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e.target.files)),t);i(r)},!1)})}},{key:"compress",value:function(e,t){function n(e,t){var n=new f.default(t);return n.start=window.performance.now(),n.alt=e.name,n.ext=e.type,n.startSize=e.size,h.default.orientation(e).then(function(t){return n.orientation=t,d.default.load(e)}).then(function(e){return function(t){return c.default.load(t).then(function(t){if(e.startWidth=t.naturalWidth,e.startHeight=t.naturalHeight,e.resize){var n=c.default.resize(e.maxWidth,e.maxHeight)(t.naturalWidth,t.naturalHeight),i=n.width,r=n.height;e.endWidth=i,e.endHeight=r}else e.endWidth=t.naturalWidth,e.endHeight=t.naturalHeight;return l.default.imageToCanvas(e.endWidth,e.endHeight,e.orientation)(t)}).then(function(t){return e.iterations=1,e.base64prefix=s.default.prefix(e.ext),function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments[5],u=l.default.canvasToBase64(t,i),d=s.default.size(u);return o+=1,d>r?e(t,d,i-.1,r,a,o):i>a?e(t,d,i-.1,r,a,o):u}(t,e.startSize,e.quality,e.size,e.minQuality,e.iterations)}).then(function(t){return e.finalSize=s.default.size(t),s.default.data(t)}).then(function(t){e.end=window.performance.now();var n=e.end-e.start;return{data:t,prefix:e.base64prefix,elapsedTimeInSeconds:n/1e3,alt:e.alt,initialSizeInMb:l.default.size(e.startSize).MB,endSizeInMb:l.default.size(e.finalSize).MB,ext:e.ext,quality:e.quality,endWidthInPx:e.endWidth,endHeightInPx:e.endHeight,initialWidthInPx:e.startWidth,initialHeightInPx:e.startHeight,sizeReducedInPercent:(e.startSize-e.finalSize)/e.startSize*100,iterations:e.iterations}})}}(n))}return Promise.all(e.map(function(e){return n(e,t)}))}}],[{key:"convertBase64ToFile",value:function(e,t){return l.default.base64ToFile(e,t)}}]),e}();e.exports=v},void 0===(a="function"==typeof i?i.apply(t,r):i)||(e.exports=a)},function(e,t,n){var i,r,a;r=[t],void 0===(a="function"==typeof(i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={size:function(e){return(e.replace(/^data:image\/\w+;base64,/,"").length-814)/1.37},mime:function(e){return e.split(";")[0].match(/jpeg|png|gif/)[0]},data:function(e){return e.replace(/^data:image\/\w+;base64,/,"")},prefix:function(e){return"data:"+e+";base64,"}}})?i.apply(t,r):i)||(e.exports=a)},function(e,t,n){var i,r,a;r=[t],void 0===(a="function"==typeof(i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={base64ToFile:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image/jpeg",n=window.atob(e),i=[],r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return new window.Blob([new Uint8Array(i)],{type:t})},imageToCanvas:function(e,t,n){var i=document.createElement("canvas"),r=i.getContext("2d");return i.width=e,i.height=t,function(a){if(!n||n>8)return r.drawImage(a,0,0,i.width,i.height),i;switch(n>4&&(i.width=t,i.height=e),n){case 2:r.translate(e,0),r.scale(-1,1);break;case 3:r.translate(e,t),r.rotate(Math.PI);break;case 4:r.translate(0,t),r.scale(1,-1);break;case 5:r.rotate(.5*Math.PI),r.scale(1,-1);break;case 6:r.rotate(.5*Math.PI),r.translate(0,-t);break;case 7:r.rotate(.5*Math.PI),r.translate(e,-t),r.scale(-1,1);break;case 8:r.rotate(-.5*Math.PI),r.translate(-e,0)}return n>4?r.drawImage(a,0,0,i.height,i.width):r.drawImage(a,0,0,i.width,i.height),i}},canvasToBase64:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.75,n=e.toDataURL("image/jpeg",t);return n},size:function(e){return{KB:e/1e3,MB:e/1e6}}}})?i.apply(t,r):i)||(e.exports=a)},function(e,t,n){var i,r,a;r=[t],void 0===(a="function"==typeof(i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={load:function(e){return new Promise(function(t,n){var i=new window.FileReader;i.addEventListener("load",function(e){t(e.target.result)},!1),i.addEventListener("error",function(e){n(e)},!1),i.readAsDataURL(e)})}}})?i.apply(t,r):i)||(e.exports=a)},function(e,t,n){var i,r,a;r=[t],void 0===(a="function"==typeof(i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={load:function(e){return new Promise(function(t,n){var i=new window.Image;i.addEventListener("load",function(){t(i)},!1),i.addEventListener("error",function(e){n(e)},!1),i.src=e})},resize:function(e,t){return function(n,i){if(!e&&!t)return{width:n,height:i};var r=n/i,a=e/t,o=void 0,u=void 0;return r>a?(o=Math.min(n,e),u=o/r):(u=Math.min(i,t),o=u*r),{width:o,height:u}}}}})?i.apply(t,r):i)||(e.exports=a)},function(e,t,n){var i,r,a;r=[t],void 0===(a="function"==typeof(i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function e(t){var n=t.quality,i=void 0===n?.75:n,r=t.size,a=void 0===r?2:r,o=t.maxWidth,u=void 0===o?1920:o,s=t.maxHeight,l=void 0===s?1920:s,d=t.resize,c=void 0===d||d;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this.start=window.performance.now(),this.end=null,this.alt=null,this.ext=null,this.startSize=null,this.startWidth=null,this.startHeight=null,this.size=1e3*a*1e3,this.endSize=null,this.endWidth=null,this.endHeight=null,this.iterations=0,this.base64prefix=null,this.quality=i,this.resize=c,this.maxWidth=u,this.maxHeight=l,this.orientation=1}})?i.apply(t,r):i)||(e.exports=a)},function(e,t,n){var i,r,a;r=[t],void 0===(a="function"==typeof(i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={orientation:function(e){return new Promise(function(t,n){var i=new window.FileReader;i.onload=function(e){var n=new DataView(e.target.result);65496!==n.getUint16(0,!1)&&t(-2);for(var i=n.byteLength,r=2;r<i;){var a=n.getUint16(r,!1);if(r+=2,65505===a){1165519206!==n.getUint32(r+=2,!1)&&t(-1);var o=18761===n.getUint16(r+=6,!1);r+=n.getUint32(r+4,o);var u=n.getUint16(r,o);r+=2;for(var s=0;s<u;s++)274===n.getUint16(r+12*s,o)&&t(n.getUint16(r+12*s+8,o))}else{if(65280!=(65280&a))break;r+=n.getUint16(r,!1)}}t(-1)},i.readAsArrayBuffer(e.slice(0,65536))})}}})?i.apply(t,r):i)||(e.exports=a)}])}});